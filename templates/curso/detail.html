{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Detalles del curso" %}{% endblock title %}

{% block content %}
<div class="container-blanco">
  <h1 id="detalles">{% trans "Detalles del curso" %}</h1>
  <hr />
  <br />

  <table class="table table-striped table-hover" aria-describedby="detalles">
    <tr>
      <th scope="row">{% trans "Id" %}</th>
      <td>{{ curso.id }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Nombre" %}</th>
      <td>{{ curso.nombre }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Año académico" %}</th>
      <td>{{ curso.anyo_academico | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Cód. asignatura Sigma" %}</th>
      <td>{{ curso.asignatura.asignatura_id | default_if_none:"—" }}</td>
    </tr>

    <tr>
      <th scope="row">{% trans "Estado" %}</th>
      <td>{{ curso.estado.nombre }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Fecha de solicitud" %}</th>
      <td>{{ curso.fecha_solicitud }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Fecha de autorización" %}</th>
      <td>{{ curso.fecha_autorizacion | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Autorizador" %}</th>
      <td>{{ curso.autorizador | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Fecha de creación" %}</th>
      <td>{{ curso.fecha_creacion | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Código en plataforma" %}</th>
      <td>{{ curso.id_nk | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "URL" %}</th>
      <td><a target="_blank" href="{{ curso.url }}">{{ curso.url | default_if_none:"—" }}</a></td>
    </tr>
    <tr>
      <th scope="row">{% trans "Categoría" %}</th>
      <td>{{ curso.categoria.nombre | default_if_none:"—" }} ({{ curso.categoria.id_nk }})</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Motivo de la solicitud" %}</th>
      <td>{{ curso.motivo_solicitud | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Comentarios" %}</th>
      <td>{{ curso.comentarios | default_if_none:"—" }}</td>
    </tr>
    <tr>
      <th scope="row">{% trans "Profesorado" %}</th>
      <td>
        <ul class="listado">
        {% for profesor in curso.profesores.all %}
          <li>{{ profesor.get_full_name }} &lt;{{profesor.email}}&gt;</li>
        {% endfor %}
        </ul>
      </td>
    </tr>
  </table>

  {% if curso.estado.nombre == "Solicitado" and perms.geo.cursos_pendientes %}
    <br />
    <h2>{% trans "Resolver la solicitud" %}</h2>
    <hr />
    <form action="{% url 'resolver-solicitud' %}" id="resolver-form" method="post">
      {% csrf_token %}
      <input type='hidden' id='id' name='id' value='{{ curso.id }}'>
      <div><strong>{% trans "Decisión" %}</strong></div>
      <div class="form-check-inline">
        <label class="form-check-label">
          <input type="radio" class="form-check-input" name="decision" value="denegar" required>
          {% trans "Denegar" %}
        </label>
      </div>
      <div class="form-check-inline">
        <label class="form-check-label">
          <input type="radio" class="form-check-input" name="decision" value="autorizar" required>
          {% trans "Autorizar" %}
        </label>
      </div>

      <div id="div_id_comentarios" class="form-group">
        <label for="id_comentarios" class="col-form-label">
          <strong>{% trans "Comentarios" %}</strong>
        </label>
        <div class="">
          <textarea name="comentarios" cols="40" rows="10" class="textarea form-control" id="id_comentarios">
          </textarea>
          <small id="hint_id_comentarios" class="form-text text-muted">
            {% trans "Si lo desea, añada una explicación para el solicitante sobre la razón de aprobar o denegar el curso solicitado." %}
          </small>
        </div>
      </div>

      <br style="clear: both;" />
      <div class="btn-group" role="group" aria-label="Botones">
        <a href="{% url 'cursos-pendientes' %}" class="btn btn-info">
          <span class="fas fa-step-backward"></span> {% trans "Retroceder" %}
        </a>
        <button type="submit" class="btn btn-warning">
          <span class="fas fa-gavel"></span> {% trans "Resolver" %}
        </button>
      </div>
    </form>
  {% endif %}
</div>
{% endblock content %}
